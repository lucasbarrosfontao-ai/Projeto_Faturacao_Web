@using ProjetoFaturacao.Services
@inject UserSession session
@inject NavigationManager Navigation

<div class="top-row ps-3 navbar navbar-dark shadow-sm">
    <div class="container-fluid">
        <a class="navbar-brand fw-bold d-flex align-items-center" href="">
            <i class="bi bi-lightning-charge-fill me-2 text-warning"></i>
            <span>FaturaFlow</span>
        </a>
    </div>
</div>

<input type="checkbox" title="Navigation menu" class="navbar-toggler" />

<div class="nav-scrollable" onclick="document.querySelector('.navbar-toggler').click()">
    <nav class="flex-column mt-2">
        
        <!-- SECÇÃO: PRINCIPAL -->
        <div class="nav-item px-3">
            <NavLink class="nav-link rounded-2" href="" Match="NavLinkMatch.All">
                <i class="bi bi-house-door-fill me-3"></i> Home
            </NavLink>
        </div>

        <div class="text-uppercase text-muted fw-bold small px-4 mt-4 mb-2" style="letter-spacing: 1px; font-size: 0.75rem;">
            Gestão Operacional
        </div>

        <div class="nav-item px-3">
            <NavLink class="nav-link rounded-2" href="Fornecedores/Ver">
                <i class="bi bi-truck me-3"></i> Fornecedores
            </NavLink>
        </div>

        <div class="nav-item px-3">
            <NavLink class="nav-link rounded-2" href="Clientes/Ver">
                <i class="bi bi-person-badge-fill me-3"></i> Clientes
            </NavLink>
        </div>

        <div class="nav-item px-3">
            <NavLink class="nav-link rounded-2" href="Produtos/Ver">
                <i class="bi bi-box-seam-fill me-3"></i> Produtos
            </NavLink>
        </div>

        <div class="text-uppercase text-muted fw-bold small px-4 mt-4 mb-2" style="letter-spacing: 1px; font-size: 0.75rem;">
            Documentação
        </div>

        <div class="nav-item px-3">
            <NavLink class="nav-link rounded-2" href="Faturas/Ver">
                <i class="bi bi-receipt-cutoff me-3"></i> Listar Faturas
            </NavLink>
        </div>
        
        <div class="nav-item px-3">
            <NavLink class="nav-link rounded-2" href="Faturas/Criar">
                <i class="bi bi-plus-circle-fill me-3 text-info"></i> Nova Fatura
            </NavLink>
        </div>

        <div class="text-uppercase text-muted fw-bold small px-4 mt-4 mb-2" style="letter-spacing: 1px; font-size: 0.75rem;">
            Relatórios & BI
        </div>

        <div class="nav-item px-3">
            <NavLink class="nav-link rounded-2" href="Vendas/VisaoGeral">
                <i class="bi bi-graph-up-arrow me-3"></i> Visão de Vendas
            </NavLink>
        </div>
        
        <!-- SECÇÃO: SISTEMA & SEGURANÇA -->
        <div class="text-uppercase text-muted fw-bold small px-4 mt-4 mb-2" style="letter-spacing: 1px; font-size: 0.75rem;">
            Sistema & Segurança
        </div>

        @if (session.IsLoggedIn)
        {
            <div class="nav-item px-3">
                <NavLink class="nav-link rounded-2" href="Utilizadores/Ver">
                    <i class="bi bi-people-fill me-3 text-info"></i> Gerir Utilizadores
                </NavLink>
            </div>

            <div class="nav-item px-3">
                <NavLink class="nav-link rounded-2" href="Utilizadores/Criar">
                    <i class="bi bi-person-plus-fill me-3 text-success"></i> Novo Utilizador
                </NavLink>
            </div>
        }

        <div class="nav-item px-3">
            <NavLink class="nav-link rounded-2" href="arquivo">
                <i class="bi bi-archive-fill me-3 text-secondary"></i> Arquivo
            </NavLink>
        </div>

        <!-- BOTÃO SAIR -->
        @if (session.IsLoggedIn)
        {
            <div class="nav-item px-3 mt-4 mb-4">
                <button class="nav-link btn btn-link w-100 text-start rounded-2 border-0" @onclick="Logout" style="color: #ff6b6b;">
                    <i class="bi bi-box-arrow-right me-3"></i> Sair do Sistema
                </button>
            </div>
        }

    </nav>
</div>

@code {
    private void Logout()
    {
        session.IsLoggedIn = false;
        Navigation.NavigateTo("/login");
    }
}
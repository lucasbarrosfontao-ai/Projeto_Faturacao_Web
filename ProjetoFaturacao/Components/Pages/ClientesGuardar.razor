@page "/cliente/guardar"
@inject ApplicationDbContext DbContext
@inject NavigationManager Navigation

<PageTitle>Guardar Cliente</PageTitle>

<h3>Guardar Cliente</h3>

<EditForm Model="@cliente" OnValidSubmit="GuardarCliente">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="form-group">
        <label for="nome">Nome:</label>
        <InputText id="nome" @bind-Value="cliente.Nome" class="form-control" />
        <ValidationMessage For="@(() => cliente.Nome)" />
    </div>

    <div class="form-group">
        <label for="nif">NIF:</label>
        <InputText id="nif" @bind-Value="cliente.NIF" class="form-control" />
        <ValidationMessage For="@(() => cliente.NIF)" />
    </div>

    <div class="form-group">
        <label for="contato">Contato:</label>
        <InputText id="contato" @bind-Value="cliente.Contato" class="form-control" />
    </div>

    <div class="form-group">
        <label for="email">Email:</label>
        <InputText id="email" @bind-Value="cliente.Email" class="form-control" />
    </div>

    <div class="form-group">
        <label for="morada">Morada:</label>
        <InputText id="morada" @bind-Value="cliente.Morada" class="form-control" />
    </div>

    <div class="form-group">
        <label for="localidade">Localidade:</label>
        <InputText id="localidade" @bind-Value="cliente.Localidade" class="form-control" />
    </div>

    <div class="form-group">
        <label for="codigoPostal">CÃ³digo Postal:</label>
        <InputText id="codigoPostal" @bind-Value="cliente.Codigo_Postal" class="form-control" />
    </div>

    <button type="submit" class="btn btn-primary">Guardar</button>
    <button type="button" class="btn btn-secondary" @onclick="Cancelar">Cancelar</button>
</EditForm>

@code {
    private Cliente cliente = new Cliente();

    private async Task GuardarCliente()
    {
        try
        {
            DbContext.Clientes.Add(cliente);
            await DbContext.SaveChangesAsync();
            Navigation.NavigateTo("/clientes/ver");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Erro ao guardar cliente: {ex.Message}");
        }
    }

    private void Cancelar()
    {
        Navigation.NavigateTo("/clientes/ver");
    }
}
